<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@"@"5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="container my-5">
        <h1 class="my-5 text-center">Weather forecast based on your location</h1>
        <div id="forecast"></div>
        <div class="text-center">
            <button id="btn" type="button" class="btn btn-success">Get forecast</button>
        </div>
    </div>

<script type="text/javascript">
    const btn = document.querySelector("#btn");
    const forecastDiv = document.querySelector("#forecast");


    async function getForecast() {
        const response = await fetch("http://77.87.205.78/forecast");
        const forecast = await response.json();
        return forecast
    }

    function renderForecastItem(item) {
        return `<div class="card" style="width: 18rem;">
            <img src="${item.icon_url}" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title">${item.time}</h5>
                <p class="card-text">${item.weather}</p>
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">Temperature: ${item.temp}</li>
                <li class="list-group-item">Humidity: ${item.humidity}%</li>
                <li class="list-group-item">Wind: ${item.wind}</li>
                <li class="list-group-item">Pressure: ${item.pressure}</li>
            </ul>
        </div>`
    }

    function renderForecast(forecast) {
        const city = forecast.city;

        const markupList = forecast.list.map(item => renderForecastItem(item));
        const markup = markupList.join();
        return markup
    }

    function process() {
        getForecast()
            .then(forecast => {
                forecastDiv.innerHTML = renderForecast(forecast);
            })
    }

    btn.addEventListener("click", process);
</script>
</body>
</html>